<script>
    const socket = io("https://laburen-agent-backend.onrender.com", {
        transports: ['polling', 'websocket'],
        upgrade: true,
        rememberUpgrade: false,
        timeout: 20000,
        forceNew: true
    });

    const form = document.getElementById('form');
    const input = document.getElementById('input');
    const messages = document.getElementById('messages');


    socket.on('connect', function() {
        console.log('Conectado al servidor');
    });

    socket.on('connect_error', function(error) {
        console.error('Error de conexi√≥n:', error);
    });

    socket.on('disconnect', function(reason) {
        console.log('Desconectado:', reason);
    });

    form.addEventListener('submit', function(e) {
        e.preventDefault();
        if (input.value && socket.connected) {
            const userMessage = document.createElement('li');
            userMessage.textContent = input.value;
            userMessage.className = 'p-3 rounded-lg bg-gray-300 text-gray-800 max-w-xs self-end ml-auto';
            messages.appendChild(userMessage);
            
            socket.emit('chat message', input.value);
            input.value = '';

            messages.scrollTop = messages.scrollHeight;
        } else if (!socket.connected) {
            console.log('Socket no conectado');
        }
    });

    socket.on('chat message', function(msg) {
        const agentMessage = document.createElement('li');
        agentMessage.textContent = msg;
        agentMessage.className = 'p-3 rounded-lg bg-blue-100 text-gray-800 max-w-xs';
        messages.appendChild(agentMessage);
        
        messages.scrollTop = messages.scrollHeight;
    });
</script>